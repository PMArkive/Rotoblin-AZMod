; This map is part of left4deadDLC4-l4d2onl4d1

; Harry modify 2023
filter:
; remove ammo and use our own settings
{
	"classname" "weapon_ammo_spawn"
}

; remove terrible pistol spawn density
{
	"classname" "weapon_pistol_spawn"
}

; from l4d2 official
add:
; ammo
{
    "origin" "-2210 -4659 571.863"
    "spawnflags" "2"
    "solid" "6"
    "model" "models/props/terror/ammo_stack.mdl"
    "disableshadows" "1"
    "count" "5"
    "angles" "0 347 0"
    "classname" "weapon_ammo_spawn"
}

{
    "origin" "6520 -1445 59.474"
    "spawnflags" "2"
    "solid" "6"
    "model" "models/props/terror/ammo_stack.mdl"
    "disableshadows" "1"
    "count" "5"
    "angles" "0 347 0"
    "classname" "weapon_ammo_spawn"
}

; from l4d2 the last stand update
add:
; anv_mapfixes
; clip
{
	; _commonhop_maproom
    "mins" "-24 -17 0"
    "maxs" "100 17 112"
    "origin" "3673 -2517 424"
    "initialstate" "1"
    "BlockType" "1"
    "classname" "env_player_blocker"
}

{
	; _cliprework_skylighta
    "mins" "-192 -193 -23"
    "maxs" "192 191 57"
    "origin" "6464 -2591 559"
    "initialstate" "1"
    "BlockType" "1"
    "classname" "env_player_blocker"
}

{
	; _cliprework_skylightb
    "mins" "-541 -189 -1"
    "maxs" "547 195 32"
    "origin" "4173 -2627 793"
    "initialstate" "1"
    "BlockType" "1"
    "classname" "env_player_blocker"
}

{
	; _cliprework_skylightc
    "mins" "-194 -544 -1"
    "maxs" "190 544 32"
    "origin" "2274 -672 793"
    "initialstate" "1"
    "BlockType" "1"
    "classname" "env_player_blocker"
}

;{
;	; _cliprework_skylightd
;    "mins" "-1017 -167 0"
;    "maxs" "1018 149 32"
;    "origin" "1465 -3418 794"
;    "angles" "0 45 0"
;    "initialstate" "1"
;    "BlockType" "1"
;    "classname" "env_player_blocker"
;}

;{
;	; _cliprework_skylightc_permstuck_colddrinks 
;	 "mins" "-1 -1 -1"
;    "maxs" "1 1 1"
;    "origin" "736 -548 363"
;    "initialstate" "1"
;    "BlockType" "0"
;    "classname" "env_player_blocker"
;}

{
	; _cliprework_skylightc_duckqol_shopliftscanners_clipleft 
	"mins" "-17 -4 -34"
    "maxs" "18 5 33"
    "origin" "5264 -2748 314"
    "initialstate" "1"
    "BlockType" "0"
    "classname" "env_player_blocker"
}

{
	; _cliprework_skylightc_duckqol_shopliftscanners_clipright 
	"mins" "-17 -4 -34"
    "maxs" "18 5 33"
    "origin" "5264 -2620 314"
    "initialstate" "1"
    "BlockType" "0"
    "classname" "env_player_blocker"
}

; trigduck
{
    ; _duckqol_shopliftscanners
    "targetname" "_duckqol_shopliftscanners"
	"spawnflags" "1"
    "origin" "5247 -2685 280"
    "classname" "trigger_auto_crouch"
}

{
	"classname" "logic_auto"
	"OnMapSpawn" "_duckqol_shopliftscanners,AddOutput,mins -2 -67 0,0,-1"
	"OnMapSpawn" "_duckqol_shopliftscanners,AddOutput,maxs 2 64 77,0,-1"
	"OnMapSpawn" "_duckqol_shopliftscanners,AddOutput,solid 2,0,-1"
}

; Moved an exposed stairwell hurt trigger down inside a vending machine.
modify:
{
    match:
    {
        "targetname" "hurt_stairwell"
    }
    replace:
    {
        "origin" "683.5 -583 307"
    }
}

; anv_versus
; kill_entity
filter:
{
    ;"origin" "-1016.5 -4510.5 561"
    ;"classname" "func_breakable"
    "hammerid" "661754"
}
{
    ;"origin" "-1155.47 -4510.5 561"
    ;"classname" "func_breakable"
    "hammerid" "661743"
}
{
    ;"origin" "-1400.5 -4510.5 561"
    ;"classname" "func_breakable"
    "hammerid" "661724"
}
{
    ;"origin" "2558.5 -408.5 561"
    ;"classname" "func_breakable"
    "hammerid" "659655"
}
{
    ;"origin" "3964.5 -2910.5 561"
    ;"classname" "func_breakable"
    "hammerid" "659155"
}
{
    ;"origin" "4099.47 -2337.5 561"
    ;"classname" "func_breakable"
    "hammerid" "659355"
}
{
    ;"origin" "4103.5 -2910.5 561"
    ;"classname" "func_breakable"
    "hammerid" "659162"
}
{
    ;"origin" "4344.5 -2337.5 561"
    ;"classname" "func_breakable"
    "hammerid" "659336"
}
{
    ;"origin" "4348.54 -2910.5 561"
    ;"classname" "func_breakable"
    "hammerid" "659181"
}
{
    ;"origin" "4483.47 -2337.5 561"
    ;"classname" "func_breakable"
    "hammerid" "659325"
}
{
    ;"origin" "4487.5 -2910.5 561"
    ;"classname" "func_breakable"
    "hammerid" "862528"
}

add:
; brush
{
    ; _losfix_end_gen
	"classname" "func_brush"
	"origin" "-1940 -4434 544"
	"targetname" "_losfix_end_gen"
}
{
	"classname" "logic_auto"
	"OnMapSpawn" "_losfix_backstreet_van,AddOutput,mins -28 -1 -8,0,-1"
	"OnMapSpawn" "_losfix_backstreet_van,AddOutput,maxs 28 1 8,0,-1"
	"OnMapSpawn" "_losfix_backstreet_van,AddOutput,solid 2,0,-1"
}

; clip
{
    ; _ladderqol_lastroom_left
    "BlockType" "2"
    "initialstate" "1"
    "mins" "-564 -3 -31"
    "maxs" "564 3 31"
    "origin" "-1280 -4503 509"
    "classname" "env_player_blocker"
}

{
    ; _ladderqol_lastroom_right
    "BlockType" "2"
    "initialstate" "1"
    "mins" "-564 -3 -31"
    "maxs" "564 3 31"
    "origin" "-1280 -3945 509"
    "classname" "env_player_blocker"
}

{
    ; _ladderqol_maproom_left
    "BlockType" "2"
    "initialstate" "1"
    "mins" "-564 -3 -31"
    "maxs" "564 3 31"
    "origin" "4224 -2903 509"
    "classname" "env_player_blocker"
}

{
    ; _ladderqol_maproom_right
    "BlockType" "2"
    "initialstate" "1"
    "mins" "-564 -3 -31"
    "maxs" "564 3 31"
    "origin" "4224 -2345 509"
    "classname" "env_player_blocker"
}

{
    ; _ladderqol_oneway_left
    "BlockType" "2"
    "initialstate" "1"
    "mins" "-3 -564 -31"
    "maxs" "3 564 31"
    "origin" "1993 -672 509"
    "classname" "env_player_blocker"
}

{
    ; _ladderqol_oneway_right
    "BlockType" "2"
    "initialstate" "1"
    "mins" "-3 -564 -31"
    "maxs" "3 564 31"
    "origin" "2551 -672 509"
    "classname" "env_player_blocker"
}

{
    ; _skylighta_blocker1
    "BlockType" "2"
    "initialstate" "1"
    "mins" "-278 -246 0"
    "maxs" "-268 246 172"
    "origin" "6463 -2592 586"
    "classname" "env_player_blocker"
}

{
    ; _skylighta_blocker2
    "BlockType" "2"
    "initialstate" "1"
    "mins" "262 -246 0"
    "maxs" "272 246 172"
    "origin" "6463 -2592 586"
    "classname" "env_player_blocker"
}

{
    ; _skylighta_blocker3
    "BlockType" "2"
    "initialstate" "1"
    "mins" "-278 -246 0"
    "maxs" "272 -236 172"
    "origin" "6463 -2592 586"
    "classname" "env_player_blocker"
}

{
    ; _skylighta_blocker4
    "BlockType" "2"
    "initialstate" "1"
    "mins" "-278 236 0"
    "maxs" "272 246 172"
    "origin" "6463 -2592 586"
    "classname" "env_player_blocker"
}

; ladder (9)
{
    ; _ladder_kappels_cloned_headroomvent
    "classname" "func_simpleladder"
    "origin" "7484 -2035.7 -148"
    "angles" "0 -90 0"
    "model" "*147"        
    "normal.x" "1.00"
    "normal.y" "0.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    ; _ladder_lastroomSE_cloned_lastroomNE
    "classname" "func_simpleladder"
    "origin" "-2176 -8448 0"
    "angles" "0 180 0"
    "model" "*23"        
    "normal.x" "0.00"
    "normal.y" "-1.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    ; _ladder_lastroomSW_cloned_lastroomNW
    "classname" "func_simpleladder"
    "origin" "-2944 -8448 0"
    "angles" "0 180 0"
    "model" "*523"        
    "normal.x" "0.00"
    "normal.y" "-1.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    ; _ladder_maproomNE_cloned_onewayNW
    "classname" "func_simpleladder"
    "origin" "3552 -4896 0"
    "angles" "0 90 0"
    "model" "*505"        
    "normal.x" "0.00"
    "normal.y" "1.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    ; _ladder_maproomNW_cloned_onewaySW
    "classname" "func_simpleladder"
    "origin" "3552 -4896 0"
    "angles" "0 90 0"
    "model" "*30"        
    "normal.x" "0.00"
    "normal.y" "1.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    ; _ladder_maproomSE_cloned_onewayNE
    "classname" "func_simpleladder"
    "origin" "3552 -4896 0"
    "angles" "0 90 0"
    "model" "*506"        
    "normal.x" "0.00"
    "normal.y" "-1.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    ; _ladder_maproomSW_cloned_onewaySE
    "classname" "func_simpleladder"
    "origin" "3552 -4896 0"
    "angles" "0 90 0"
    "model" "*31"        
    "normal.x" "0.00"
    "normal.y" "-1.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    ; _ladder_scaffold_cloned_sodavent
    "classname" "func_simpleladder"
    "origin" "-895 -3732 -25"
    "angles" "0 0 0"
    "model" "*15"        
    "normal.x" "1.00"
    "normal.y" "0.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    ; _ladder_toystoreceiling_cloned_ventexcessheight
    "classname" "func_simpleladder"
    "origin" "3799 -586 173"
    "angles" "0.00 -90.00 0.00"
    "model" "*509"        
    "normal.x" "-0.70"
    "normal.y" "-0.70"
    "normal.z" "0.00"
}

; prop
{
	"classname" "prop_dynamic"
    ; _cosmetic_breakwall1
	"model" "models/props_interiors/breakwall_interior_noboards.mdl"
	"origin" "238.1 -2505.6 344"
	"angles" "0 -45 0"
	"disableshadows" "1"
	"solid" "0"
}

{
    ; _cosmetic_breakwall2
	"classname" "prop_dynamic"
	"model" "models/props_interiors/breakwall_interior_noboards.mdl"
	"origin" "236.9 -2504.9 348"
	"angles" "0 -225 0"
    "disableshadows" "1"
    "solid" "0"
}

{
    ; _ladder_toyvent1
	"classname" "prop_dynamic"
	"model" "models/props_exteriors/guardshack_break07.mdl"
	"origin" "1271 -2310 431"
	"angles" "0 315 -95"
    "disableshadows" "1"
    "solid" "0"
}

{
    ; _ladder_toyvent2
	"classname" "prop_dynamic"
	"model" "models/props_exteriors/guardshack_break07.mdl"
	"origin" "1279 -2304 518"
	"angles" "0 300 85"
    "disableshadows" "1"
    "solid" "0"
}

{
    ; _ladder_toyvent3
	"classname" "prop_dynamic"
	"model" "models/props_exteriors/guardshack_break02.mdl"
	"origin" "1158 -2421 554"
	"angles" "0 125 0"
    "disableshadows" "1"
    "solid" "0"
}

{
    ; _ladder_toyvent4
	"classname" "prop_dynamic"
	"model" "models/props_vents/vent_cluster006.mdl"
	"origin" "1412 -2172 560.35"
	"angles" "0 315 0"
    "disableshadows" "1"
    "solid" "6"
}

{
    ; _ladder_toyvent5
	"classname" "prop_dynamic"
	"model" "models/props_vents/vent_cluster006.mdl"
	"origin" "1043 -2538 561"
	"angles" "0 315 0"
    "disableshadows" "1"
    "solid" "6"
}

; trigmove
{
    ; _duckqol_justforkidz
    "targetname" "_duckqol_justforkidz"
	"classname" "trigger_playermovement"
    "spawnflags" "2049"
    "origin" "1191.3 -2026 521"
}
{
	"classname" "logic_auto"
	"OnMapSpawn" "_duckqol_justforkidz,AddOutput,mins -18 -18 0,0,-1"
	"OnMapSpawn" "_duckqol_justforkidz,AddOutput,maxs 18 18 1,-1"
	"OnMapSpawn" "_duckqol_justforkidz,AddOutput,solid 2,0,-1"
}

; from l4d2-zonemod
; ############  DIRECTOR AND EVENT CHANGES  ###########
; =====================================================
; ==          DIRECTOR & EVENT MODIFICATION          ==
; ==       Modify director behaviour and events      ==
; =====================================================
; --- Remove a script that caused natural hordes to spawn before the event
filter:
;{
;	"hammerid" "8442672"
;}
; --- Remove entity that affects the event path route based on the "event" removed above
;{
;	"targetname" "compare_minifinale"
;}
; --- Remove natural horde script after the event
modify:
{
	match:
	{
		"hammerid" "320879"
	}
	delete:
	{
		"OnPressed" "directorBeginScriptc1_mall_crescendo_cooldown0-1"
	}
	insert:
	{
		"OnPressed" "director,EndScript,,0,-1"
	}
}
; --- Force survivors to always take the lower path leading to the event
modify:
;{
;	match:
;	{
;		"hammerid" "1310374"
;	}
;	insert:
;	{
;		"OnMapSpawn" "relay_hallway_closeTrigger0-1"
;	}
;}
{
    match:
    {
        ;"targetname" "case_minifinale_vs"
        ;"classname" "logic_versus_random"
        "hammerid" "15283239"
    }
    delete:
    {
        "OnRandom02" "relay_hallway_close,Trigger,,0,-1"
        "OnRandom01" "relay_stairwell_close,Trigger,,0,-1"
    }
    insert:
    {
        "OnRandom01" "relay_hallway_close,Trigger,,0,-1"
    }
}
; --- Open up the Just For Kidz store so tanks don't need to use the vent, survivors can still go to this area but the path back remains blocked
filter:
{
	"targetname" "trigger_glass_breakable"
}
{
	"targetname" "brush_shop_blocked"
}
{
	"targetname" "breakble_glass_minifinale"
}
{
	"targetname" "nav_blocker_storefront"
}
{
	"targetname" "window_glow"
}
{
	"targetname" "instructor_window"
}
{
	"targetname" "filter_breakglass"
}
{
	"targetname" "filter_melee"
}
{
	"targetname" "filter_invunerable"
}
{
	"targetname" "trigger_glass_breakable"
}
{
	"targetname" "prop_door_mallshop_straight"
}
; --- Remove a trigger on the upper path that sets the escalator positions
;{
;	"hammerid" "221997"
;}
; --- Close the partially open door before the store
;modify:
;{
;	match:
;	{
;		"hammerid" "118980"
;	}
;	replace:
;	{
;		"ajarangles" "0 315 0"
;	}
;}
; --- Create our own custom case for spawning the escalators we want
;add:
;{
;	"classname" "logic_relay"
;	"targetname" "relay_elevator_path_custom"
;	"origin" "1280 -3328 9"
;	"StartDisabled" "0"
;	"spawnflags" "0"
;	; --- Event - Lower floor - Spawn both
;	"OnTrigger" "escalator_lower_01*,FireUser1,,0,-1"
;	"OnTrigger" "escalator_lower_02*,FireUser1,,0,-1"
;	; --- Event - Upper floor - Spawn standard versus path
;	"OnTrigger" "escalator_upper_01*,FireUser1,,0,-1"
;	; --- Saferoom - Lower floor - Spawn escalator leading away from the upper escalators
;	"OnTrigger" "escalator_lower_04*,FireUser1,,0,-1"
;	; --- Saferoom - Upper floor - Spawn standard versus path
;	"OnTrigger" "escalator_upper_03*,FireUser1,,0,-1"
;}
filter:
{
    "targetname" "c_p"
}
{
    "targetname" "/.*rl_el_p_.*/"
}
add:
{
	"classname" "logic_relay"
	"targetname" "relay_elevator_path_custom"
	"origin" "1280 -3328 9"
	"StartDisabled" "0"
	"spawnflags" "0"
	; --- Event - Lower floor - Spawn both
	;"OnTrigger" "e_l_01*,FireUser1,,0,-1"
	"OnTrigger" "e_l_02*,FireUser1,,0,-1"
	; --- Event - Upper floor - Spawn standard versus path
	"OnTrigger" "e_up_01*,FireUser1,,0,-1"
	; --- Saferoom - Lower floor - Spawn escalator leading away from the upper escalators
	"OnTrigger" "e_l_04*,FireUser1,,0,-1"
	; --- Saferoom - Upper floor - Spawn standard versus path
	;"OnTrigger" "e_up_03*,FireUser1,,0,-1"
}
modify:
{
	match:
	{
		"classname" "info_gamemode"
        "hammerid" "253925"
	}
	delete:
	{
		"OnVersus" "c_p_vs,PickRandom,,3,-1"
	}
	insert:
	{
		"OnVersus" "relay_elevator_path_custom,Trigger,,3,-1"
	}
}
; --- Remove other relay for setting paths as a precaution (the trigger for it seems to be missing)
filter:
;{
;	"targetname" "relay_director_set_paths2"
;}
; --- Remove items on the upper path
; --- Keep the items in the Just For Kidz area so survivors can still choose to shop for items/ammo
; --- Room opposite to Just For Kidz pill room
;{
;	"hammerid" "1549716"
;}
;{
;	"hammerid" "1549729"
;}
;{
;	"hammerid" "1313698"
;}
{
	;"origin"     "30 -2309 312"
	"classname"   "weapon_molotov_spawn"
	"hammerid"    "15415217"
}
{
	;"origin"     "23 -2307 311"
	"classname"   "weapon_pistol_spawn"
	"hammerid"    "1549741"
}
{
	;"origin"     "0 -2294 311"
	"classname"   "weapon_pipe_bomb_spawn"
	"hammerid"    "1549729"
}
; --- Bathroom items
;{
;	"hammerid" "321240"
;}
;{
;	"hammerid" "321242"
;}
;{
;	"hammerid" "321244"
;}
;{
;	"hammerid" "321246"
;}
;{
;	"hammerid" "321238"
;}
;{
;	"hammerid" "321236"
;}
;{
;	"hammerid" "321316"
;}
;{
;	"hammerid" "321318"
;}
;{
;	"hammerid" "321314"
;}
;{
;	"hammerid" "321310"
;}
;{
;	"hammerid" "321312"
;}
; --- Room opposite to bathrooms
;{
;	"hammerid" "1551939"
;}
;{
;	"hammerid" "1551926"
;}
{
	;"origin"     "1013 -1689 318"
	"classname"   "weapon_molotov_spawn"
	"hammerid"    "15415225"
}
{
	;"origin"     "994 -1669 317"
	"classname"   "weapon_pipe_bomb_spawn"
	"hammerid"    "1551939"
}
{
	;"origin"     "629 -1416 319"
	"classname"   "weapon_molotov_spawn"
	"hammerid"    "15415161"
}
{
	;"origin"     "616 -1419 319"
	"classname"   "weapon_pipe_bomb_spawn"
	"hammerid"    "321312"
}
{
	;"origin"     "323 -1417 281"
	"classname"   "weapon_pipe_bomb_spawn"
	"hammerid"    "321318"
}
{
	;"origin"     "524 -1590 282"
	"classname"   "weapon_molotov_spawn"
	"hammerid"    "15415171"
}
{
	;"origin"     "353 -1722 282"
	"classname"   "weapon_molotov_spawn"
	"hammerid"    "15415181"
}
{
	;"origin"     "327 -1713 281"
	"classname"   "weapon_pipe_bomb_spawn"
	"hammerid"    "321240"
}
{
	;"origin"     "390 -1551 281"
	"classname"   "weapon_pipe_bomb_spawn"
	"hammerid"    "321244"
}
{
	;"origin"     "428 -1572 282"
	"classname"   "weapon_molotov_spawn"
	"hammerid"    "15415175"
}
{
	;"origin"     "491 -1422 282"
	"classname"   "weapon_molotov_spawn"
	"hammerid"    "15415165"
}


; ################  ITEM SPAWN CHANGES  ###############
; =====================================================
; ==           PILL / ITEM / WEAPON SPAWNS           ==
; ==   Remove or change pill, item & weapon spawns   ==
; =====================================================
; --- Remove a badly placed item spawn at the start that is impossible to reach and in an area with plenty of other item spawns
filter:
;{
;	"hammerid" "8442701"
;}
{
	;"origin"     "6225 -1919 73"
	"classname"   "weapon_molotov_spawn"
	"hammerid"    "15412057"
}
; --- Add guarenteed spawns for shotgun and SMG in the back corner before the event path
add:
{
	"origin" "2795 -1781 302"
	"angles" "0 90 90"
	"solid" "6"
	"classname" "weapon_autoshotgun_spawn"
	"spawnflags" "2"
	"count" "5"
}
modify:
{
	match:
	{
		"hammerid" "321383"
	}
	replace:
	{
		"classname" "weapon_smg_spawn"
	}
}
; --- Move the pill cabinet on the lower route to the other side of the wall
{
	match:
	{
		"hammerid" "354455"
	}
	replace:
	{
		"origin" "880 -2457 0.224243"
		"angles" "0 180 0"
	}
}

; =====================================================
; ==                STATIC AMMO PILES                ==
; ==          Add or modify ammo pile spawns         ==
; =====================================================
add:
; --- Ammo pile by the gun spawn after the 2nd set of escalators
{
	"classname" "weapon_ammo_spawn"
	"origin" "3578 -2683 -64"
	"angles" "0 90 0"
	"model" "models/props/terror/ammo_stack.mdl"
	"solid" "6"
	"disableshadows" "1"
	"spawnflags" "2"
	"count" "5"
}
; --- Stop nearby item spawn from being an ammo pile
;modify:
;{
;	match:
;	{
;		"hammerid" "321575"
;	}
;	replace:
;	{
;		"item1" "0"
;	}
;}
filter:
{
	;"targetname" "case1"
	"hammerid" "3824"
}
add:
; --- Ammo pile on boxes near the start of the path leading to the event
{
	"classname" "weapon_ammo_spawn"
	"origin" "746 -681 32"
	"angles" "0 90 0"
	"model" "models/props/terror/ammo_stack.mdl"
	"solid" "6"
	"disableshadows" "1"
	"spawnflags" "2"
	"count" "5"
}
; --- Ammo pile before the button at the end of the event
{
	"classname" "weapon_ammo_spawn"
	"origin" "284 -4793 536"
	"angles" "0 90 0"
	"model" "models/props/terror/ammo_stack.mdl"
	"solid" "6"
	"disableshadows" "1"
	"spawnflags" "2"
	"count" "5"
}

; =====================================================
; ==                 HITTABLE CHANGES                ==
; ==           Add/remove/modify hittables           ==
; =====================================================
; --- Move the hand truck at the start of the event path to a less obtrusive position
modify:
{
	match:
	{
		"hammerid" "49558"
	}
	replace:
	{
		"origin" "782 -1147 280"
		"angles" "0 90 0"
	}
}


; #############  MAP CLIPPING AND ISSUES  #############
; =====================================================
; ==                 EXPLOITS BLOCKED                ==
; ==      Block intentionally performed exploits     ==
; =====================================================
add:
; --- Block standing on a door frame by the drop leading to the event
{
	"classname" "env_player_blocker"
	"origin" "1509 -993 466"
	"mins" "-34 -1 -70"
	"maxs" "34 1 70"
	"initialstate" "1"
	"BlockType" "1"
}
; --- Block skipping the path to the end saferoom
{
	"classname" "env_player_blocker"
	"origin" "-1744 -4509 634"
	"mins" "-112 -3 -94"
	"maxs" "112 3 94"
	"initialstate" "1"
	"BlockType" "1"
}

; =====================================================
; ==                  OUT OF BOUNDS                  ==
; ==  Block players getting outside / under the map  ==
; =====================================================

; =====================================================
; ==                   STUCK SPOTS                   ==
; ==  Prevent players from getting stuck in the map  ==
; =====================================================

; =====================================================
; ==                 NUISANCE CHANGES                ==
; ==      Clipping improvements, QOL map changes     ==
; =====================================================
; --- Make the office chair used for the return shortcut solid
modify:
{
	match:
	{
		"hammerid" "1553193"
	}
	replace:
	{
		"spawnflags" "256"
	}
}
; --- Remove glass that looks like leftover beta content hiding inside another glass panel
filter:
{
	"hammerid" "1574131"
}
; --- Remove some glass panels around the event to help infected
; --- Glass by main escalator
{
	"hammerid" "1663586"
}
{
	"hammerid" "1663589"
}
{
	"hammerid" "1663577"
}
{
	"hammerid" "1663574"
}
{
	"hammerid" "1663571"
}
; --- Glass by ladders lower floor
{
	"hammerid" "1663688"
}
{
	"hammerid" "1663700"
}
{
	"hammerid" "1663736"
}
{
	"hammerid" "1663712"
}
{
	"hammerid" "1663721"
}
{
	"hammerid" "1663853"
}
{
	"hammerid" "1663844"
}
{
	"hammerid" "1663868"
}
{
	"hammerid" "1663835"
}
{
	"hammerid" "1663778"
}
{
	"hammerid" "1663820"
}
{
	"hammerid" "1663787"
}
{
	"hammerid" "8564847"
}
; --- Glass by ladders, top floor
{
	"hammerid" "1663490"
}
{
	"hammerid" "1663580"
}
{
	"hammerid" "1663502"
}
{
	"hammerid" "1663565"
}
{
	"hammerid" "1663553"
}
{
	"hammerid" "1663514"
}
{
	"hammerid" "1663535"
}
{
	"hammerid" "1663655"
}
{
	"hammerid" "1663613"
}
{
	"hammerid" "1663646"
}
{
	"hammerid" "8565094"
}
; --- Remove some glass panels around the end saferoom to help infected
{
	"hammerid" "661764"
}
{
	"hammerid" "661565"
}
{
	"hammerid" "1310382"
}
{
	"hammerid" "661584"
}
{
	"hammerid" "661626"
}
{
	"hammerid" "661636"
}
{
	"hammerid" "661645"
}
{
	"hammerid" "661656"
}

; ###########  ADDITIONAL PROPS AND SPAWNS  ###########
; =====================================================
; ==                      PROPS                      ==
; ==       New props for balance and SI spawns       ==
; =====================================================
add:
; --- Fence cover prop immediately outside saferoom
{
	"classname" "prop_dynamic"
	"origin" "6708 -1748 -18"
	"angles" "0 97.5 0"
	"model" "models/props_urban/fence_cover001_128.mdl"
	"solid" "6"
	"disableshadows" "1"
}
; --- Fence cover prop by the collapsed gate after the first set of escalators
{
	"classname" "prop_dynamic"
	"origin" "5196 -2585 280"
	"angles" "0 75 0"
	"model" "models/props_mall/mall_display_07.mdl"
	"solid" "6"
	"disableshadows" "1"
}
;{
;	"classname" "env_player_blocker"
;	"origin" "5196 -2585 428"
;	"angles" "0 75 0"
;	"mins" "-18 -48 -60"
;	"maxs" "18 48 60"
;	"boxmins" "-18 -48 -60"
;	"boxmaxs" "18 48 60"
;	"initialstate" "1"
;	"BlockType" "1"
;}
; --- Fence cover props in front of the escalators on the far side in the second escalator room
{
	"classname" "prop_dynamic"
	"origin" "3598 -2691 280"
	"angles" "0 39 0"
	"model" "models/props_mall/mall_display_07.mdl"
	"solid" "6"
	"disableshadows" "1"
}
;{
;	"classname" "env_player_blocker"
;	"origin" "3598 -2691 428"
;	"angles" "0 39 0"
;	"mins" "-18 -48 -60"
;	"maxs" "18 48 60"
;	"boxmins" "-18 -48 -60"
;	"boxmaxs" "18 48 60"
;	"initialstate" "1"
;	"BlockType" "1"
;}
; --- Fence cover prop in the dark area in the second escalator room
{
	"classname" "prop_dynamic"
	"origin" "2928 -2814 280"
	"angles" "0 136.5 0"
	"model" "models/props_mall/mall_display_07.mdl"
	"solid" "6"
	"disableshadows" "1"
}
;{
;	"classname" "env_player_blocker"
;	"origin" "2928 -2814 428"
;	"angles" "0 136.5 0"
;	"mins" "-18 -48 -60"
;	"maxs" "18 48 60"
;	"boxmins" "-18 -48 -60"
;	"boxmaxs" "18 48 60"
;	"initialstate" "1"
;	"BlockType" "1"
;}
; --- Fence cover prop on the right after going down second set of escalators
{
	"classname" "prop_dynamic"
	"origin" "3703 -2285 0"
	"angles" "0 129 0"
	"model" "models/props_mall/mall_display_07.mdl"
	"solid" "6"
	"disableshadows" "1"
}
;{
;	"classname" "env_player_blocker"
;	"origin" "3703 -2285 148"
;	"angles" "0 129 0"
;	"mins" "-18 -48 -60"
;	"maxs" "18 48 60"
;	"boxmins" "-18 -48 -60"
;	"boxmaxs" "18 48 60"
;	"initialstate" "1"
;	"BlockType" "1"
;}
; --- Fence cover prop in front after going down second set of escalators
{
	"classname" "prop_dynamic"
	"origin" "3167 -2707 0"
	"angles" "0 189.5 0"
	"model" "models/props_mall/mall_display_07.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "env_player_blocker"
	"origin" "3167 -2707 148"
	;"angles" "0 189.5 0"
	"mins" "-18 -48 -60"
	"maxs" "18 48 60"
	;"boxmins" "-18 -48 -60"
	;"boxmaxs" "18 48 60"
	"initialstate" "1"
	"BlockType" "1"
}
; --- Fence cover prop to the left of the drop leading to the event path
{
	"classname" "prop_dynamic"
	"origin" "1778 -1144 280"
	"angles" "0 264 0"
	"model" "models/props_mall/mall_display_07.mdl"
	"solid" "6"
	"disableshadows" "1"
}
;{
;	"classname" "env_player_blocker"
;	"origin" "1778 -1144 428"
;	"angles" "0 264 0"
;	"mins" "-18 -48 -60"
;	"maxs" "18 48 60"
;	"boxmins" "-18 -48 -60"
;	"boxmaxs" "18 48 60"
;	"initialstate" "1"
;	"BlockType" "1"
;}
; --- Props to separate the open area before the drop leading to the event
{
	"classname" "prop_dynamic"
	"origin" "2272 -1680 251"
	"angles" "0 0 0"
	"model" "models/props_mall/mall_column_large.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "prop_dynamic"
	"origin" "2220.12 -1736.43 280"
	"angles" "0 150 0"
	"model" "models/props_mall/mall_display_07.mdl"
	"solid" "6"
	"disableshadows" "1"
}
;{
;	"classname" "env_player_blocker"
;	"origin" "2220.12 -1736.43 424"
;	;"angles" "0 -30 0"
;	"mins" "-16 -48 -64"
;	"maxs" "16 48 64"
;	"boxmins" "-16 -48 -64"
;	"boxmaxs" "16 49 64"
;	"initialstate" "1"
;	"BlockType" "1"
;}
{
	"classname" "prop_dynamic"
	"origin" "2192 -1899 280"
	"angles" "0 180 0"
	"model" "models/props_mall/mall_display_08.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "env_player_blocker"
	"origin" "2192 -1899 448"
	"mins" "-18 -112 -40"
	"maxs" "18 112 40"
	"initialstate" "1"
	"BlockType" "1"
}
; --- Desk to block survivors from standing in a safe on the drop to the event path
{
	"classname" "prop_dynamic"
	"origin" "1636 -1107 419"
	"angles" "0 0 -76.5"
	"model" "models/props_office/desk_01.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "env_player_blocker"
	"origin" "1660 -1088 396"
	"mins" "-47 -32 -116"
	"maxs" "47 32 116"
	"initialstate" "1"
	"BlockType" "1"
}
; --- Vending machine to return on the one-way drop
{
	"classname" "prop_dynamic"
	"origin" "1613 -1087 303"
	"angles" "0 90 -90"
	"model" "models/props_equipment/snack_machine2.mdl"
	"solid" "6"
	"disableshadows" "1"
}
; --- Clip to make the jump easier for survivors
{
	"classname" "env_player_blocker"
	"origin" "1615 -1024 311"
	"mins" "-4 -32 -31"
	"maxs" "4 32 31"
	"initialstate" "1"
	"BlockType" "1"
}
; --- Fence cover props at the entrance of the final area after the event
{
	"classname" "prop_dynamic"
	"origin" "-91 -4425 280"
	"angles" "0 67.5 0"
	"model" "models/props_mall/mall_display_07.mdl"
	"solid" "6"
	"disableshadows" "1"
}
;{
;	"classname" "env_player_blocker"
;	"origin" "-91 -4425 428"
;	"angles" "0 67.5 0"
;	"mins" "-18 -48 -60"
;	"maxs" "18 48 60"
;	"boxmins" "-18 -48 -60"
;	"boxmaxs" "18 48 60"
;	"initialstate" "1"
;	"BlockType" "1"
;}
; --- Kiosk on floor below the end saferoom
{
	"classname" "prop_dynamic"
	"origin" "-2068 -4208 280"
	"angles" "0 270 0"
	"model" "models/props_mall/mall_kioskc.mdl"
	"solid" "6"
	"disableshadows" "1"
}
; --- Shelf by the escalator leading to the end saferoom
{
	"classname" "prop_dynamic"
	"origin" "-1025 -3929 280"
	"angles" "0 270 0"
	"model" "models/props_mall/mall_display_07.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "prop_dynamic"
	"origin" "-1025 -3932 356"
	"angles" "0 270 0"
	"model" "models/props_fortifications/barricade_razorwire001_128_reference.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "env_player_blocker"
	"origin" "-1025 -3929 416"
	"mins" "-48 -18 -56"
	"maxs" "48 18 56"
	"initialstate" "1"
	"BlockType" "1"
}
; --- Kiosks on the upper floor by the end saferoom
{
	"classname" "prop_dynamic"
	"origin" "-479 -4381 536"
	"angles" "0 270 0"
	"model" "models/props_mall/mall_kioskc.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "prop_dynamic"
	"origin" "-479 -4061 536"
	"angles" "0 90 0"
	"model" "models/props_mall/mall_kioskc.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "prop_dynamic"
	"origin" "-2055 -3973 536"
	"angles" "0 90 0"
	"model" "models/props_mall/mall_kioskc.mdl"
	"solid" "6"
	"disableshadows" "1"
}
; --- Boxes and plywood on the upper floor by the end saferoom
{
	"classname" "prop_dynamic"
	"origin" "-2129 -4288 536"
	"angles" "0 57.5 0"
	"model" "models/props/cs_militia/boxes_garage_lower.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "prop_dynamic"
	"origin" "-2115 -4268 536"
	"angles" "0 15 0"
	"model" "models/props_industrial/plywood_leaning.mdl"
	"solid" "6"
	"disableshadows" "1"
}

; =====================================================
; ==             LADDER / ELEVATOR NERF              ==
; ==   Nerf ladder & elevator attacks for infected   ==
; =====================================================


; ############  MAP SOUND AND GFX CHANGES  ############
; =====================================================
; ==                  SOUND REMOVAL                  ==
; ==    Remove or adjust sounds played by the map    ==
; =====================================================
; --- Fade out event alarm sound after a few seconds
;modify:
;{
;	match:
;	{
;		"targetname" "relay_door_minifinale"
;	}
;	insert:
;	{
;		"OnTrigger" "sound_alarm,FadeOut,5,3,-1"
;		"OnTrigger" "sound_alarm,Kill,,10,-1"
;	}
;}

; =====================================================
; ==             GFX / PARTICLES REMOVAL             ==
; ==        Remove visual effects from the map       ==
; =====================================================


; ###############  TRIGGERS AND BRUSHES  ##############
; =====================================================
; ==                   CLIP REMOVAL                  ==
; ==      Remove miscellaneous clips and brushes     ==
; =====================================================

; =====================================================
; ==              TRIGGER REMOVAL / FIX              ==
; ==    Fix triggers that interfere with gameplay    ==
; =====================================================


; #############  LADDER CHANGES AND FIXES  ############
; =====================================================
; ==             LADDER ADDITIONS / FIXES            ==
; ==              Add or change ladders              ==
; =====================================================

; #######  MISCELLANEOUS / MAP SPECIFIC CHANGES  ######
; =====================================================
; ==              SAFEROOM ROUTE REWORK              ==
; ==   Make the route to the saferoom to be longer   ==
; =====================================================
add:
; --- Block going immediately left through the fences after the under construction area
{
	"classname" "prop_dynamic"
	"origin" "-760 -4689 280"
	"angles" "0 166 0"
	"model" "models/props_fortifications/barricade001_128_reference.mdl"
	"solid" "6"
	"disableshadows" "1"
}
; --- Shelves to block going directly to the escalator
;{
;	"classname" "prop_dynamic"
;	"origin" "-960 -4128 280"
;	"angles" "0 270 0"
;	"model" "models/props_mall/mall_display_08.mdl"
;	"solid" "6"
;	"disableshadows" "1"
;}
;{
;	"classname" "prop_dynamic"
;	"origin" "-900 -4124 409"
;	"angles" "0 90 0"
;	"model" "models/props_fortifications/barricade_razorwire001_128_reference.mdl"
;	"solid" "6"
;	"disableshadows" "1"
;}
;{
;	"classname" "prop_dynamic"
;	"origin" "-1020 -4124 409"
;	"angles" "0 90 0"
;	"model" "models/props_fortifications/barricade_razorwire001_128_reference.mdl"
;	"solid" "6"
;	"disableshadows" "1"
;}
;{
;	"classname" "prop_dynamic"
;	"origin" "-861 -4122 283"
;	"angles" "0 195 0"
;	"model" "models/deadbodies/cemetary/pose_c.mdl"
;	"solid" "0"
;	"disableshadows" "1"
;}
;{
;	"classname" "env_player_blocker"
;	"origin" "-960 -4128 635"
;	"mins" "-112 -18 -227"
;	"maxs" "112 18 227"
;	"initialstate" "1"
;	"BlockType" "1"
;}
{
	"classname" "prop_dynamic"
	"origin" "-684 -4204 280"
	"angles" "0 0 0"
	"model" "models/props_mall/mall_display_08.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "prop_dynamic"
	"origin" "-692 -4144 409"
	"angles" "0 180 0"
	"model" "models/props_fortifications/barricade_razorwire001_128_reference.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "prop_dynamic"
	"origin" "-692 -4264 409"
	"angles" "0 180 0"
	"model" "models/props_fortifications/barricade_razorwire001_128_reference.mdl"
	"solid" "6"
	"disableshadows" "1"
}
{
	"classname" "env_player_blocker"
	"origin" "-684 -4204 448"
	"mins" "-18 -112 -40"
	"maxs" "18 112 40"
	"initialstate" "1"
	"BlockType" "1"
}
; --- Fences to block going directly to the escalator
;{
;	"classname" "prop_dynamic"
;	"origin" "-680 -4032 280"
;	"angles" "0 165 0"
;	"model" "models/props_fortifications/barricade001_128_reference.mdl"
;	"solid" "6"
;	"disableshadows" "1"
;}
;{
;	"classname" "env_player_blocker"
;	"origin" "-671 -4034 456"
;	;"angles" "0 165 0"
;	"mins" "-8 -48 -32"
;	"maxs" "8 48 32"
;	;"boxmins" "-8 -48 -32"
;	;"boxmaxs" "8 48 32"
;	"initialstate" "1"
;	"BlockType" "1"
;}
;{
;	"classname" "prop_dynamic"
;	"origin" "-668 -3928 280"
;	"angles" "0 180 0"
;	"model" "models/props_fortifications/barricade001_128_reference.mdl"
;	"solid" "6"
;	"disableshadows" "1"
;}
;{
;	"classname" "prop_dynamic"
;	"origin" "-668 -3820 280"
;	"angles" "0 180 0"
;	"model" "models/props_fortifications/barricade001_128_reference.mdl"
;	"solid" "6"
;	"disableshadows" "1"
;}
;{
;	"classname" "env_player_blocker"
;	"origin" "-659 -3874 456"
;	"mins" "-8 -102 -32"
;	"maxs" "8 102 32"
;	"initialstate" "1"
;	"BlockType" "1"
;}
; --- Fences on construction lift to block jumping around
;{
;	"classname" "prop_dynamic"
;	"origin" "-1139 -4176 249"
;	"angles" "0 270 0"
;	"model" "models/props_exteriors/roadsidefence_64.mdl"
;	"solid" "6"
;	"disableshadows" "1"
;}
;{
;	"classname" "env_player_blocker"
;	"origin" "-1139 -4176 572"
;	"mins" "-33 -3 -290"
;	"maxs" "33 3 290"
;	"initialstate" "1"
;	"BlockType" "1"
;}
;{
;	"classname" "prop_dynamic"
;	"origin" "-1167 -4208 249"
;	"angles" "0 0 0"
;	"model" "models/props_exteriors/roadsidefence_64.mdl"
;	"solid" "6"
;	"disableshadows" "1"
;}
;{
;	"classname" "env_player_blocker"
;	"origin" "-1168 -4209 572"
;	"mins" "-4 -31 -290"
;	"maxs" "4 31 290"
;	"initialstate" "1"
;	"BlockType" "1"
;}
; --- Dead body on construction lift
{
	"classname" "prop_dynamic"
	"origin" "-1171 -4276 278"
	"angles" "0 165 0"
	"model" "models/deadbodies/common_worker_male01_fence01.mdl"
	"solid" "0"
	"disableshadows" "1"
}
; --- Additional clipping to prevent gaps survivors can go through
;{
;	"classname" "env_player_blocker"
;	"origin" "-1089 -4108 572"
;	"mins" "-16 -18 -290"
;	"maxs" "16 18 290"
;	"initialstate" "1"
;	"BlockType" "1"
;}
;{
;	"classname" "env_player_blocker"
;	"origin" "-1103 -4143 572"
;	"mins" "-2 -16 -290"
;	"maxs" "2 16 290"
;	"initialstate" "1"
;	"BlockType" "1"
;}
; ---  Infected ladders to climb over the shelves
;{
;	"classname" "func_simpleladder"
;	"origin" "-389.93 -1136.49 23"
;	"angles" "0 315 0"
;	"model" "*509"
;	"normal.x" "0.00"
;	"normal.y" "-1.00"
;	"normal.z" "0.00"
;	"team" "2"
;}
;{
;	"classname" "func_simpleladder"
;	"origin" "-1528.06 -7119.5 23"
;	"angles" "0 135 0"
;	"model" "*509"
;	"normal.x" "0.00"
;	"normal.y" "1.00"
;	"normal.z" "0.00"
;	"team" "2"
;}

; Harry personal settings
filter:
; env_entity_maker failed to find template
{
    "targetname" "/.*m_mq_s_f-IA.*/"
}
{
    "targetname" "/.*m_mq_s_m-IA.*/"
}
{
    "targetname" "/.*t_mq-IA.*/"
}
{
    "targetname" "/.*c_mq-IA.*/"
}

; broken escalator
{
    "targetname" "/.*e_up_04.*/"
}
{
    "targetname" "/.*e_up_03.*/"
}

; stupid door
{
	;"origin" "1286.5 -5322.5 591.5"
	"targetname" "door_sliding"
}

; remove glass near end saferoom
{
	;"origin"     "-1084 -4353 307"
	"classname"   "func_breakable"
	"hammerid"    "661514"
}
{
	;"origin"     "-1084 -4203 307"
	"classname"   "func_breakable"
	"hammerid"    "661525"
}
{
	;"origin"     "-1084 -4072 305"
	"classname"   "func_breakable"
	"hammerid"    "1813544"
}
{
	;"origin"     "-1153 -4012 307"
	"classname"   "func_breakable"
	"hammerid"    "661290"
}
{
	;"origin"     "-1284 -4014 307"
	"classname"   "func_breakable"
	"hammerid"    "661303"
}
{
	;"origin"     "-1411 -4012 307"
	"classname"   "func_breakable"
	"hammerid"    "661312"
}
{
	;"origin"     "-1537 -4012 307"
	"classname"   "func_breakable"
	"hammerid"    "661323"
}
{
	;"origin"     "-1664 -4014 307"
	"classname"   "func_breakable"
	"hammerid"    "661333"
}
{
	;"origin"     "-1787 -4012 307"
	"classname"   "func_breakable"
	"hammerid"    "661342"
}
{
	;"origin"     "-1853 -4095 307"
	"classname"   "func_breakable"
	"hammerid"    "661353"
}
{
	;"origin"     "-1853 -4245 307"
	"classname"   "func_breakable"
	"hammerid"    "661364"
}
{
	;"origin"     "-1853 -4377 305"
	"classname"   "func_breakable"
	"hammerid"    "1814977"
}
{
	;"origin"     "-1783 -4437 307"
	"classname"   "func_breakable"
	"hammerid"    "661450"
}
{
	;"origin"     "-1656 -4435 307"
	"classname"   "func_breakable"
	"hammerid"    "661464"
}
{
	;"origin"     "-1533 -4437 307"
	"classname"   "func_breakable"
	"hammerid"    "661473"
}
{
	;"origin"     "-1407 -4437 307"
	"classname"   "func_breakable"
	"hammerid"    "661484"
}
{
	;"origin"     "-1276 -4435 307"
	"classname"   "func_breakable"
	"hammerid"    "661494"
}
{
	;"origin"     "-1149 -4437 307"
	"classname"   "func_breakable"
	"hammerid"    "661503"
}
{
	;"origin"     "-1160 -3938 561"
	"classname"   "func_breakable"
	"hammerid"    "661596"
}
{
	;"origin"     "-1284 -3940 561"
	"classname"   "func_breakable"
	"hammerid"    "661606"
}
{
	;"origin"     "-1405 -3938 561"
	"classname"   "func_breakable"
	"hammerid"    "661615"
}

; --- Remove item spawns in bad locations or excessive density in a location
{
	;"origin"     "6783 -3375 71"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412974"
}
{
	;"origin"     "6573 -2632 33"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412958"
}
{
	;"origin"     "6454 -2374 25"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412956"
}
{
	;"origin"     "6029 -1957 25"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412970"
}
{
	;"origin"     "6289 -2709 65"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412960"
}
{
	;"origin"     "5999 -3259 25"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412962"
}
{
	;"origin"     "6029 -3492 61"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412964"
}
{
	;"origin"     "5358 -2748 1"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412966"
}
{
	;"origin"     "5371 -2495 17"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412968"
}
{
	;"origin"     "6635 -1839 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412954"
}
{
	;"origin"     "7438 -2932 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412950"
}
{
	;"origin"     "6769 -3381 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412948"
}
{
	;"origin"     "5541 -1740 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412930"
}
{
	;"origin"     "5394 -1737 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412928"
}
{
	;"origin"     "5664 -2202 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412932"
}
{
	;"origin"     "5469 -2846 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412942"
}
{
	;"origin"     "5565 -3374 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412946"
}
{
	;"origin"     "5724 -3260 306"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412944"
}
{
	;"origin"     "2972 -3146 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415958"
}
{
	;"origin"     "3309 -2585 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415956"
}
{
	;"origin"     "3634 -2718 -62"
	"classname"   "weapon_molotov_spawn"
	"hammerid"    "15415123"
}
{
	;"origin"     "3616 -2697 -63"
	"classname"   "weapon_pipe_bomb_spawn"
	"hammerid"    "321575"
}
{
	;"origin"     "3851 2 1"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415962"
}
{
	;"origin"     "623 -1422 319"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15416004"
}
{
	;"origin"     "499 -1423 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415998"
}
{
	;"origin"     "344 -1423 318"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15416000"
}
{
	;"origin"     "520 -1566 319"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15416002"
}
{
	;"origin"     "356 -1596 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415996"
}
{
	;"origin"     "339 -1739 281"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415994"
}
{
	;"origin"     "-141 -5108 346"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15416020"
}
{
	;"origin"     "-1988 -4225 288"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15416026"
}
{
	;"origin"     "-461 -3890 -24"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15416024"
}
{
	;"origin"     "6886 -1844 78"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15412972"
}
{
	;"origin"     "6 -2301 320"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415992"
}
{
	;"origin"     "706 -2339 64"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415972"
}
{
	;"origin"     "477 -2343 44"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415978"
}
{
	;"origin"     "335 -2131 44"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415980"
}
{
	;"origin"     "335 -2344 44"
	"classname"   "weapon_pain_pills_spawn"
	"hammerid"    "15415982"
}
{
	;"origin"     "399 -1993 44"
	"hammerid"    "15415976"
}

; --- Remove item spawns in bad locations or excessive density in a location
{
    ; kit
    "hammerid" "1799576"
}
{
    ; kit
    "hammerid" "1799574"
}
{
    ; kit
    "hammerid" "1799570"
}
{
    ; kit
    "hammerid" "1799572"
}

; =====================================================
; ===============  PILL CABINET TWEAK  ================
; =====================================================
modify:
; weapons spawn
{
    match:
    {
        "targetname" "case_weapons_spawn_vs"
    }
    delete:
    {
		"OnRandom01" "tmp_case1,ForceSpawn,,0,-1"
		"OnRandom02" "relay_null,Trigger,,0,-1"
    }
	insert:
	{
		"OnRandom01" "relay_null,Trigger,,0,-1"
	}
}

add:
; ammo
{
	"solid" "6"
	"classname"	"weapon_ammo_spawn"
	"origin" "-1163 -4508 0"
	"angles" "0 -90 0"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"model"	 "models/props/terror/ammo_stack.mdl"
	"count"	"5"
}

; weapons
{
	"solid" "6"
	"classname"	"weapon_pumpshotgun_spawn"
	"origin" "-368 -4222 310"
	"angles" "0 290 -90"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"5"
}

{
	"solid" "6"
	"classname"	"weapon_smg_spawn"
	"origin" "-271 -4230 310"
	"angles" "0 434 -90"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"5"
}

{
	"solid" "6"
	"classname"	"weapon_pumpshotgun_spawn"
	"origin" "1000 -223 31"
	"angles" "0 367 -90"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"5"
}

{
	"solid" "6"
	"classname"	"weapon_smg_spawn"
	"origin" "3624 -2728 -63"
	"angles" "0 186 -90"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"5"
}

; pistol
{
	"solid" "6"
	"classname"	"weapon_pistol_spawn"
	"origin" "5176.46 -2856.12 281.03"
	"angles" "0.00 176.70 270.00"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"1"
}

{
	"solid" "6"
	"classname"	"weapon_pistol_spawn"
	"origin" "1043.62 -866.96 311.96"
	"angles" "0.00 97.86 270.00"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"1"
}

{
	"solid" "6"
	"classname"	"weapon_pistol_spawn"
	"origin" "823.00 -5318.59 537.03"
	"angles" "0.00 169.36 270.00"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"1"
}

{
	"solid" "6"
	"classname"	"weapon_pistol_spawn"
	"origin" "3598.18 -2713.65 -62.96"
	"angles" "0.00 142.07 270.00"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"1"
}

{
	"solid" "6"
	"classname"	"weapon_pistol_spawn"
	"origin" "1020.31 -1963.50 310.96"
	"angles" "0.00 294.96 270.00"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"1"
}

{
	"solid" "6"
	"classname"	"weapon_pistol_spawn"
	"origin" "1097.84 -5428.34 281.03"
	"angles" "0.00 75.27 270.00"
	"spawnflags"	"2"
	"disableshadows"	"1"
	"count"	"1"
}

; object
{
	"solid" "6"
	"origin" "-747 -4127 284"
	"angles" "0 87 0"
	"model"	 "models/deadbodies/dead_female_civilian_02.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-748 -4027 280"
	"angles" "0 -1 0"
	"model"	 "models/props_mall/mall_display_08.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-704 -4579 280"
	"angles" "0 -177 0"
	"model"	 "models/props_fortifications/barricade001_128_reference.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-698 -4445 280"
	"angles" "0 177 0"
	"model"	 "models/props_fortifications/barricade001_128_reference.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-697 -4355 280"
	"angles" "0 177 0"
	"model"	 "models/props_fortifications/barricade001_64_reference.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1240 -3925 280"
	"angles" "0 -94 0"
	"model"	 "models/props_mall/mall_display_08.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1410 -4012 286"
	"angles" "0 -12 -3"
	"model"	 "models/props_mall/mall_display_08.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-896 -4000 280"
	"angles" "0 90 0"
	"model"	 "models/props_mall/mall_display_08.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-934 -3929 280"
	"angles" "0 0 0"
	"model"	 "models/props_mall/mall_display_03.mdl"
	"classname"	"prop_dynamic"
}
{
	"solid" "6"
	"origin" "-1440 -4481 285"
	"angles" "0 180 -2"
	"model"	 "models/props_mall/mall_display_08.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1688 -4407 0"
	"angles" "0 359 0"
	"model"	 "models/props_unique/airport/luggage_pile1.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-926 -4288 -21"
	"angles" "-6 176 0"
	"model"	 "models/props/cs_militia/boxes_frontroom.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1400 -4652 280"
	"angles" "0 357 0"
	"model"	 "models/props_mall/mall_display_07.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-681 -4428 -32"
	"angles" "0 8 0"
	"model"	 "models/props_mall/mall_display_07.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1291 -4572 0"
	"angles" "0 8 0"
	"model"	 "models/props/cs_militia/boxes_frontroom.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-760 -4172 280"
	"angles" "0 356 0"
	"model"	 "models/props_mall/mall_directory.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1204 -4445 0"
	"angles" "0 -181 0"
	"model"	 "models/props_mall/mall_display_08.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1364 -4556 280"
	"angles" "0 179 0"
	"model"	 "models/props/cs_militia/boxes_frontroom.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1153 -3862 536"
	"angles" "0 358 0"
	"model"	 "models/props_mall/mall_display_04.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1478 -3828 536"
	"angles" "0 -2 0"
	"model"	 "models/props/cs_militia/crate_extralargemill.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1298 -4594 536"
	"angles" "0 -5 0"
	"model"	 "models/props/de_nuke/crate_extralarge.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1829 -3811 536"
	"angles" "0 -180 0"
	"model"	 "models/props/de_nuke/crate_small.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1425 -4393 315"
	"angles" "360 179 268"
	"model"	 "models/props_highway/highway_sign006.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-699 -4151 325"
	"angles" "0 360 0"
	"model"	 "models/props_highway/highway_sign004.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-845 -4016 318"
	"angles" "0 90 28"
	"model"	 "models/props_highway/highway_sign006.mdl"
	"classname"	"prop_dynamic"
}

{
	"solid" "6"
	"origin" "-1188 -4389 46"
	"angles" "0 179 120"
	"model"	 "models/props_highway/highway_sign006.mdl"
	"classname"	"prop_dynamic"
}

; block
{
	; saferoom block
	"BlockType" "0"
	"initialstate" "1"
	"mins" "-600 0 0"
	"maxs" "0 0 120"
	"origin" "7032 -1325 154"
    "classname" "env_player_blocker"
}

{
	; saferoom block
	"BlockType" "0"
	"initialstate" "1"
	"mins" "-200 0 0"
	"maxs" "0 0 120"
	"origin" "7032 -1522 154"
    "classname" "env_player_blocker"
}

; flare
{
	"solid" "6"
	"fadescale" "0"
	"origin" "-1141 -4533 0"
	"disableshadows" "1"
	"model" "models/props_lighting/light_flares.mdl"
	"classname" "prop_dynamic"
}
{
	"origin" "-1140 -4531 0"
	"angles" "-45 -120 0"
	"rendercolor" "200 20 15"
	"rendermode" "9"
	"spotlightwidth" "1"
	"spotlightlength" "3"
	"renderamt" "255"
	"spawnflags" "1"
	"disableshadows" "1"
	"classname" "point_spotlight"
}
{
	"origin" "-1140 -4531 0"
	"style" "6"
	"_light" "200 20 15 255"
	"brightness" "1"
	"spotlight_radius" "32"
	"distance" "350"
	"classname" "light_dynamic"
}
{
	"origin" "-1140 -4533 1"
	"start_active" "1"
	"effect_name" "flare_burning"
	"cpoint7_parent" "0"
	"cpoint6_parent" "0"
	"cpoint5_parent" "0"
	"cpoint4_parent" "0"
	"cpoint3_parent" "0"
	"cpoint2_parent" "0"
	"cpoint1_parent" "0"
	"angles" "-90 0 0"
	"classname" "info_particle_system"
}

; ladder
{
    "classname" "func_simpleladder"
    "origin" "-227.92 -1009.48 22.00"
    "angles" "0.00 315.00 0.00"
    "model" "*509"        
    "normal.x" "0.00"
    "normal.y" "-1.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    "classname" "func_simpleladder"
    "origin" "-3914.34 -3378.73 1.03"
    "angles" "0.00 45.00 0.00"
    "model" "*509"        
    "normal.x" "1.00"
    "normal.y" "0.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    "classname" "func_simpleladder"
    "origin" "271.95 168.05 -504.96"
    "angles" "0.00 0.00 0.00"
    "model" "*523"        
    "normal.x" "0.00"
    "normal.y" "1.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    "classname" "func_simpleladder"
    "origin" "-2290.67 -9054.74 -505.96"
    "angles" "0.00 180.00 0.00"
    "model" "*23"        
    "normal.x" "0.00"
    "normal.y" "-1.00"
    "normal.z" "0.00"
    "team" "2"
}

{
    "classname" "func_simpleladder"
    "origin" "-2218.45 -6857.49 -96.96"
    "angles" "0.00 130.00 0.00"
    "model" "*526"        
    "normal.x" "-0.99"
    "normal.y" "0.08"
    "normal.z" "0.00"
    "team" "2"
}

; add our own horde after open alarm door on 1st floor
filter:
{
	"targetname" "trigger_gauntlet_up"
}
;{
;	"targetname" "trigger_gauntlet_down"
;}
{
	"targetname" "battlefield"
}
{
	"targetname" "zombiecounter"
}
{
	"targetname" "panic_timer"
}
{
	"targetname" "panic_relay"
}
{
	"classname" "info_zombie_spawn"
}

modify:
; fix alarm glow
{
	match:
	{
		;"targetname" "prop_alarm_controls"
		"hammerid" "254805"
	}
	replace:
	{
		"classname" "prop_glowing_object"
	}
	insert:
	{
		"GlowForTeam" "2"
		"StartGlowing" "0"
	}
}
; alarm door on 1st floor
{
	match:
	{
		;"targetname" "activator_panic1"
		"hammerid" "3851"
	}
	delete:
	{
		"OnPass" "battlefield,Enable,,0,-1"
		"OnPass" "panic_timer,Enable,,0,1"
		"OnPass" "zombiecounter,Enable,,0,-1"
		"OnPass" "trigger_gauntlet_up,Kill,,0,-1"
		;"OnPass" "trigger_gauntlet_down,Kill,,0,-1"
	}
	insert:
	{
		"OnPass" "director,PanicEventControlled,1,0,1"
		"OnPass" "panic_forever_timer,Enable,,0.1,1"
	}
}

; generator switch to turn off the alarm
{
	match:
	{
		;"origin" "988 -5176 584.22"
		;"classname" "func_button"
		"hammerid" "320879"
	}
	delete:
	{
		"OnPressed" "director,BeginScript,c1_mall_crescendo_cooldown,0,-1"
		"OnPressed" "door_sliding,Toggle,,0,-1"
		"OnPressed" "zombiecounter,Disable,,0,-1"
		"OnPressed" "battlefield,Disable,,0,-1"
		"OnPressed" "panic_timer,Disable,,0.01,-1"
	}
	insert:
	{
		"OnPressed" "prop_alarm_controls,StopGlowing,,0,-1"
		"OnPressed" "panic_forever_timer,Disable,,0.01,-1"
	}
}

add:
{
	; panic event forever every 40 seconds
	"origin" "1528 -3568 14.26"
	"targetname" "panic_forever_timer"
	"StartDisabled" "1"
	"spawnflags" "0"
	"RefireTime" "40"
	"classname" "logic_timer"
	"OnTimer" "director,PanicEvent,,0,-1"
}